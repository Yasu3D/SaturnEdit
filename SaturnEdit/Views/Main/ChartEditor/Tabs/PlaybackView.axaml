<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:icon="clr-namespace:FluentIcons.Avalonia;assembly=FluentIcons.Avalonia"
             mc:Ignorable="d"
             d:DesignWidth="800"
             d:DesignHeight="200"
             x:Class="SaturnEdit.Views.Main.ChartEditor.Tabs.PlaybackView"
             MinHeight="79"
             MaxHeight="79">
    <Grid RowDefinitions="1,Auto">
        <Rectangle Grid.Row="0"
                   Fill="{DynamicResource SeparatorSecondary}"/>
        
        <Grid Grid.Row="1" ColumnDefinitions="Auto,*"
              Height="78"
              Background="{DynamicResource BackgroundPrimary}">
            <!-- Playback Controls -->
            <Grid Column="0"
                  ColumnDefinitions="77,1,Auto,1">

                <!-- Play/Stop Button -->
                <ToggleButton Classes="Themed Concave"
                              CornerRadius="0"
                              ToolTip.VerticalOffset="5"
                              ToolTip.Placement="Top">
                    <ToolTip.Tip>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{DynamicResource ChartEditor.Playback.ToolTip.Play}" />
                            <TextBlock Text="TODO: KEYBIND"
                                       Margin="15,0,0,0"
                                       HorizontalAlignment="Right"
                                       Foreground="{DynamicResource ForegroundSecondary}" />
                        </StackPanel>
                    </ToolTip.Tip>
                    <icon:FluentIcon Icon="Play" FontSize="28"/>
                </ToggleButton>
            
                <Rectangle Grid.Column="1"
                           Width="1"
                           VerticalAlignment="Stretch"
                           Fill="{DynamicResource SeparatorSecondary}" />
            
                <!-- Playback Settings -->
                <Grid Column="2"
                      RowDefinitions="38, 1, 38">
                
                    <!-- Playback Speed -->
                    <Grid>
                        <Grid Margin="5"
                              IsHitTestVisible="False">
                            <Rectangle Name="TickPlaybackSpeed25"
                                       Width="1"
                                       Margin="0"
                                       HorizontalAlignment="Left"
                                       Fill="{DynamicResource SeparatorPrimary}"/>
                            <Rectangle Name="TickPlaybackSpeed50"
                                       Width="1"
                                       Margin="0"
                                       HorizontalAlignment="Left"
                                       Fill="{DynamicResource SeparatorPrimary}"/>
                            <Rectangle Name="TickPlaybackSpeed100"
                                       Width="1"
                                       Margin="0"
                                       HorizontalAlignment="Left"
                                       Fill="{DynamicResource SeparatorPrimary}"/>
                            <Rectangle Name="TickPlaybackSpeed200"
                                       Width="1"
                                       Margin="0"
                                       HorizontalAlignment="Left"
                                       Fill="{DynamicResource SeparatorPrimary}"/>
                        </Grid>
                        <Slider Grid.Row="0"
                                Name="SliderPlaybackSpeed"
                                Classes="Wide"
                                TickFrequency="5"
                                IsSnapToTickEnabled="True"
                                Minimum="0"
                                Maximum="300"
                                Value="100"
                                ValueChanged="SliderPlaybackSpeed_OnValueChanged">
                            <ToolTip.Tip>
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{DynamicResource ChartEditor.Playback.ToolTip.PlaybackSpeed}" />
                                        <TextBlock Text="TODO: KEYBIND"
                                                   Margin="15,0,0,0"
                                                   HorizontalAlignment="Right"
                                                   Foreground="{DynamicResource ForegroundSecondary}" />
                                    </StackPanel>
                                
                                    <TextBlock Text="{DynamicResource ChartEditor.Playback.ToolTip.PlaybackSpeed.Description}" Foreground="{DynamicResource ForegroundSecondary}" />
                                </StackPanel>
                            </ToolTip.Tip>
                        </Slider>
                        <TextBlock Name="TextBlockPlaybackSpeed"
                                   Text="100%"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   TextAlignment="Right"
                                   FontSize="15"
                                   FontFamily="Consolas,Cascadia Code,Monospace"
                                   IsHitTestVisible="False"
                                   Foreground="{DynamicResource ForegroundPrimary}"
                                   Opacity="0.3" />
                    </Grid>
                
                    <Rectangle Grid.Row="1"
                               Height="1"
                               HorizontalAlignment="Stretch"
                               Fill="{DynamicResource SeparatorSecondary}" />
                
                    <!-- Setting Buttons -->
                    <StackPanel Grid.Row="2"
                                Orientation="Horizontal">
                        <ToggleButton Classes="Themed Square Accent"
                                      Margin="4,4,2,4"
                                      ToolTip.VerticalOffset="5"
                                      ToolTip.Placement="Top">
                            <ToolTip.Tip>
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{DynamicResource ChartEditor.Playback.ToolTip.Loop}" />
                                        <TextBlock Text="TODO: KEYBIND"
                                                   Margin="15,0,0,0"
                                                   HorizontalAlignment="Right"
                                                   Foreground="{DynamicResource ForegroundSecondary}" />
                                    </StackPanel>
                                
                                    <TextBlock Text="{DynamicResource ChartEditor.Playback.ToolTip.Loop.Description}" Foreground="{DynamicResource ForegroundSecondary}" />
                                </StackPanel>
                            </ToolTip.Tip>
                            <icon:FluentIcon Icon="ArrowRepeatAll"/>
                        </ToggleButton>
                    
                        <Button Classes="Themed Square Standard"
                                Margin="2,4"
                                ToolTip.VerticalOffset="5"
                                ToolTip.Placement="Top">
                            <ToolTip.Tip>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource ChartEditor.Playback.ToolTip.LoopStart}" />
                                    <TextBlock Text="TODO: KEYBIND"
                                               Margin="15,0,0,0"
                                               HorizontalAlignment="Right"
                                               Foreground="{DynamicResource ForegroundSecondary}" />
                                </StackPanel>
                            </ToolTip.Tip>
                            <icon:FluentIcon Icon="ArrowTurnDownRight"/>
                        </Button>
                    
                        <Button Classes="Themed Square Standard"
                                Margin="2,4"
                                ToolTip.VerticalOffset="5"
                                ToolTip.Placement="Top">
                            <ToolTip.Tip>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{DynamicResource ChartEditor.Playback.ToolTip.LoopEnd}" />
                                    <TextBlock Text="TODO: KEYBIND"
                                               Margin="15,0,0,0"
                                               HorizontalAlignment="Right"
                                               Foreground="{DynamicResource ForegroundSecondary}" />
                                </StackPanel>
                            </ToolTip.Tip>
                            <icon:FluentIcon Icon="ArrowTurnUpLeft"/>
                        </Button>
                    
                        <ToggleButton Classes="Themed Square Accent"
                                      Margin="2,4"
                                      ToolTip.VerticalOffset="5"
                                      ToolTip.Placement="Top">
                            <ToolTip.Tip>
                                <StackPanel>
                                    <TextBlock Text="{DynamicResource ChartEditor.Playback.ToolTip.Metronome}" />
                                    <TextBlock Text="{DynamicResource ChartEditor.Playback.ToolTip.Metronome.Description}" Foreground="{DynamicResource ForegroundSecondary}" />
                                </StackPanel>
                            </ToolTip.Tip>
                            <PathIcon Data="{DynamicResource IconMetronome}"
                                      Width="14"
                                      Foreground="{DynamicResource ForegroundPrimary}"
                                      Margin="1,0,0,0" /> <!-- The margin is here because my icon is a little bit off-center... -->
                        </ToggleButton>
                    
                        <Button Classes="Themed Square Standard"
                                Margin="2,4,4,4"
                                ToolTip.VerticalOffset="5"
                                ToolTip.Placement="Top">
                            <ToolTip.Tip>
                                <StackPanel>
                                    <TextBlock Text="{DynamicResource ChartEditor.Playback.ToolTip.PlaybackSettings}" />
                                    <TextBlock Text="{DynamicResource ChartEditor.Playback.ToolTip.PlaybackSettings.Description}" Foreground="{DynamicResource ForegroundSecondary}" />
                                </StackPanel>
                            </ToolTip.Tip>
                            <icon:FluentIcon Icon="Settings"/>
                            <Button.Flyout>
                                <MenuFlyout Placement="BottomEdgeAlignedLeft">
                                    <MenuItem>
                                        <MenuItem.Header>
                                            <TextBlock Text="{DynamicResource Settings.Playback.QuantizedPause}" />
                                        </MenuItem.Header>

                                        <MenuItem ToggleType="Radio"
                                                  GroupName="QuantizePause"
                                                  IsChecked="True">
                                            <MenuItem.Header>
                                                <TextBlock Text="{DynamicResource Settings.Playback.QuantizedPauseOff}" />
                                            </MenuItem.Header>
                                        </MenuItem>
                                        <MenuItem ToggleType="Radio"
                                                  GroupName="QuantizePause">
                                            <MenuItem.Header>
                                                <TextBlock Text="{DynamicResource Settings.Playback.QuantizedPauseNearest}" />
                                            </MenuItem.Header>
                                        </MenuItem>
                                        <MenuItem ToggleType="Radio"
                                                  GroupName="QuantizePause">
                                            <MenuItem.Header>
                                                <TextBlock Text="{DynamicResource Settings.Playback.QuantizedPausePrevious}" />
                                            </MenuItem.Header>
                                        </MenuItem>
                                        <MenuItem ToggleType="Radio"
                                                  GroupName="QuantizePause">
                                            <MenuItem.Header>
                                                <TextBlock Text="{DynamicResource Settings.Playback.QuantizedPauseNext}" />
                                            </MenuItem.Header>
                                        </MenuItem>
                                    </MenuItem>

                                    <MenuItem ToggleType="CheckBox" IsChecked="True">
                                        <MenuItem.Header>
                                            <TextBlock Text="{DynamicResource Settings.Playback.LoopToStart}" />
                                        </MenuItem.Header>
                                    </MenuItem>
                                </MenuFlyout>
                            </Button.Flyout>
                        </Button>
                    </StackPanel>
                </Grid>
            
                <Rectangle Grid.Column="3"
                           Width="1"
                           VerticalAlignment="Stretch"
                           Fill="{DynamicResource SeparatorSecondary}" />
            
            </Grid>
        
            <!-- Seek Slider -->
            <Slider Grid.Column="1" 
                    Classes="Wide"
                    Margin="0,0,0,1"/>
        </Grid>
    </Grid>
</UserControl>